{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import React,{useState,useContext}from\"react\";import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import Modal from\"react-native-web/dist/exports/Modal\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import TextInput from\"react-native-web/dist/exports/TextInput\";import Alert from\"react-native-web/dist/exports/Alert\";import AsyncStorage from'@react-native-async-storage/async-storage';import Button from\"./Button\";import{signup,login}from\"../services/api\";import{saveToken}from\"../services/auth\";import{useTheme}from\"../contexts/ThemeContext\";import{WalletContext}from\"../contexts/WalletContext\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";var LoginModal=function LoginModal(_ref){var visible=_ref.visible,onClose=_ref.onClose,navigation=_ref.navigation;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),identifier=_useState2[0],setIdentifier=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useTheme=useTheme(),colors=_useTheme.colors;var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var _useContext=useContext(WalletContext),fetchWalletData=_useContext.fetchWalletData,setIsLoggedIn=_useContext.setIsLoggedIn;var handleLogin=function(){var _ref2=_asyncToGenerator(function*(){try{var data=yield login(username,password);yield AsyncStorage.setItem('userToken',data.token);setIsLoggedIn(true);fetchWalletData();}catch(error){console.error('Login failed:',error);}});return function handleLogin(){return _ref2.apply(this,arguments);};}();return _jsx(Modal,{visible:visible,animationType:\"slide\",transparent:true,children:_jsx(View,{style:styles.modalContainer,children:_jsxs(View,{style:[styles.modalContainer,{backgroundColor:colors.background}],children:[_jsx(Text,{style:[styles.title,{color:colors.text}],children:\"Login\"}),_jsx(TextInput,{style:styles.input,placeholder:\"Username or Email\",placeholderTextColor:colors.placeholder,value:identifier,onChangeText:setIdentifier}),_jsx(TextInput,{style:[styles.input,{color:colors.text,borderColor:colors.border}],placeholder:\"Password\",placeholderTextColor:colors.placeholder,value:password,onChangeText:setPassword,secureTextEntry:true}),error?_jsx(Text,{style:styles.errorText,children:error}):null,_jsx(Button,{title:\"Login\",onPress:handleLogin}),_jsx(Button,{title:\"Cancel\",onPress:onClose,style:styles.cancelButton})]})})});};var styles=StyleSheet.create({modalContainer:{flex:1,justifyContent:\"center\",alignItems:\"center\",backgroundColor:\"rgba(0, 0, 0, 0.5)\"},modalContent:{backgroundColor:\"white\",padding:20,borderRadius:10,width:\"80%\"},title:{fontSize:24,fontWeight:\"bold\",marginBottom:20,textAlign:\"center\"},errorText:{color:\"red\",marginBottom:10},input:{width:\"100%\",height:40,borderWidth:1,borderRadius:5,paddingHorizontal:10,marginBottom:10},cancelButton:{marginTop:10,backgroundColor:\"gray\"}});export default LoginModal;","map":{"version":3,"names":["React","useState","useContext","View","Text","Modal","StyleSheet","TextInput","Alert","AsyncStorage","Button","signup","login","saveToken","useTheme","WalletContext","jsx","_jsx","jsxs","_jsxs","LoginModal","_ref","visible","onClose","navigation","_useState","_useState2","_slicedToArray","identifier","setIdentifier","_useState3","_useState4","password","setPassword","_useTheme","colors","_useState5","_useState6","error","setError","_useContext","fetchWalletData","setIsLoggedIn","handleLogin","_ref2","_asyncToGenerator","data","username","setItem","token","console","apply","arguments","animationType","transparent","children","style","styles","modalContainer","backgroundColor","background","title","color","text","input","placeholder","placeholderTextColor","value","onChangeText","borderColor","border","secureTextEntry","errorText","onPress","cancelButton","create","flex","justifyContent","alignItems","modalContent","padding","borderRadius","width","fontSize","fontWeight","marginBottom","textAlign","height","borderWidth","paddingHorizontal","marginTop"],"sources":["C:/appdev/btcwallet/src/components/LoginModal.js"],"sourcesContent":["import React, { useState, useContext } from \"react\";\r\nimport { View, Text, Modal, StyleSheet, TextInput, Alert } from \"react-native\";\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport Button from \"./Button\";\r\nimport { signup, login } from \"../services/api\";\r\nimport { saveToken } from \"../services/auth\";\r\nimport { useTheme } from \"../contexts/ThemeContext\";\r\nimport { WalletContext } from \"../contexts/WalletContext\";\r\n\r\nconst LoginModal = ({ visible, onClose, navigation }) => {\r\n  const [identifier, setIdentifier] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const { colors } = useTheme();\r\n  const [error, setError] = useState(\"\");\r\n  const { fetchWalletData, setIsLoggedIn } = useContext(WalletContext);\r\n\r\n  const handleLogin = async () => {\r\n    try {\r\n      const data = await login(username, password);\r\n      await AsyncStorage.setItem('userToken', data.token);\r\n      setIsLoggedIn(true);\r\n      fetchWalletData();\r\n    } catch (error) {\r\n      console.error('Login failed:', error);\r\n      // Show error message to user\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Modal visible={visible} animationType=\"slide\" transparent>\r\n      <View style={styles.modalContainer}>\r\n        <View\r\n          style={[\r\n            styles.modalContainer,\r\n            { backgroundColor: colors.background },\r\n          ]}\r\n        >\r\n          <Text style={[styles.title, { color: colors.text }]}>Login</Text>\r\n          <TextInput\r\n            style={styles.input}\r\n            placeholder=\"Username or Email\"\r\n            placeholderTextColor={colors.placeholder}\r\n            value={identifier}\r\n            onChangeText={setIdentifier}\r\n          />\r\n          <TextInput\r\n            style={[\r\n              styles.input,\r\n              { color: colors.text, borderColor: colors.border },\r\n            ]}\r\n            placeholder=\"Password\"\r\n            placeholderTextColor={colors.placeholder}\r\n            value={password}\r\n            onChangeText={setPassword}\r\n            secureTextEntry\r\n          />\r\n          {error ? <Text style={styles.errorText}>{error}</Text> : null}\r\n          <Button title=\"Login\" onPress={handleLogin} />\r\n          <Button\r\n            title=\"Cancel\"\r\n            onPress={onClose}\r\n            style={styles.cancelButton}\r\n          />\r\n        </View>\r\n      </View>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  modalContainer: {\r\n    flex: 1,\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    backgroundColor: \"rgba(0, 0, 0, 0.5)\",\r\n  },\r\n  modalContent: {\r\n    backgroundColor: \"white\",\r\n    padding: 20,\r\n    borderRadius: 10,\r\n    width: \"80%\",\r\n  },\r\n  title: {\r\n    fontSize: 24,\r\n    fontWeight: \"bold\",\r\n    marginBottom: 20,\r\n    textAlign: \"center\",\r\n  },\r\n  errorText: {\r\n    color: \"red\",\r\n    marginBottom: 10,\r\n  },\r\n  input: {\r\n    width: \"100%\",\r\n    height: 40,\r\n    borderWidth: 1,\r\n    borderRadius: 5,\r\n    paddingHorizontal: 10,\r\n    marginBottom: 10,\r\n  },\r\n  cancelButton: {\r\n    marginTop: 10,\r\n    backgroundColor: \"gray\",\r\n  },\r\n});\r\n\r\nexport default LoginModal;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}