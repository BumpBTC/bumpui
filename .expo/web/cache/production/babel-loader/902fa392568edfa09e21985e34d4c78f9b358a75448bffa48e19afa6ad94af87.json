{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import React,{useState,useContext}from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import TextInput from\"react-native-web/dist/exports/TextInput\";import Alert from\"react-native-web/dist/exports/Alert\";import{useTheme}from'../contexts/ThemeContext';import{WalletContext}from'../contexts/WalletContext';import Button from'../components/Button';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";var BuyBitcoinScreen=function BuyBitcoinScreen(){var _useTheme=useTheme(),colors=_useTheme.colors;var _useContext=useContext(WalletContext),exchangeRates=_useContext.exchangeRates;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),amount=_useState2[0],setAmount=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isBtc=_useState4[0],setIsBtc=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var handleBuy=function(){var _ref=_asyncToGenerator(function*(){setIsLoading(true);try{var response=yield axios.get('https://api.moonpay.com/v3/currencies/btc/buy_quote',{params:{apiKey:'YOUR_MOONPAY_API_KEY',baseCurrencyAmount:isBtc?(parseFloat(amount)/exchangeRates.bitcoin.usd).toFixed(2):amount,baseCurrencyCode:'usd',fixed:true}});var _response$data=response.data,quoteCurrencyAmount=_response$data.quoteCurrencyAmount,feeAmount=_response$data.feeAmount,extraFeeAmount=_response$data.extraFeeAmount,networkFeeAmount=_response$data.networkFeeAmount,totalAmount=_response$data.totalAmount;Alert.alert('Buy Bitcoin',`You will receive ${quoteCurrencyAmount} BTC for ${totalAmount} USD (including fees)`,[{text:'Cancel',style:'cancel'},{text:'Confirm',onPress:function onPress(){return initiateTransaction(totalAmount);}}]);}catch(error){console.error('Error fetching MoonPay quote:',error);Alert.alert('Error','Failed to get quote from MoonPay');}finally{setIsLoading(false);}});return function handleBuy(){return _ref.apply(this,arguments);};}();var initiateTransaction=function(){var _ref2=_asyncToGenerator(function*(totalAmount){Alert.alert('Transaction Initiated',`You're being redirected to complete the purchase of ${amount} ${isBtc?'BTC':'USD'} worth of Bitcoin.`);});return function initiateTransaction(_x){return _ref2.apply(this,arguments);};}();var toggleCurrency=function toggleCurrency(){setIsBtc(!isBtc);setAmount('');};return _jsxs(View,{style:[styles.container,{backgroundColor:colors.background}],children:[_jsx(Text,{style:[styles.title,{color:colors.text}],children:\"Buy Bitcoin\"}),_jsxs(View,{style:styles.inputContainer,children:[_jsx(TextInput,{style:[styles.input,{color:colors.text,borderColor:colors.border}],value:amount,onChangeText:setAmount,keyboardType:\"numeric\",placeholder:`Enter amount in ${isBtc?'BTC':'USD'}`,placeholderTextColor:colors.placeholder}),_jsx(Button,{title:isBtc?'BTC':'USD',onPress:toggleCurrency,style:styles.currencyToggle})]}),!isBtc&&_jsxs(Text,{style:[styles.conversionText,{color:colors.text}],children:[\"\\u2248 \",amount?(parseFloat(amount)/exchangeRates.bitcoin.usd).toFixed(8):'0',\" BTC\"]}),_jsx(Button,{title:\"Buy Bitcoin\",onPress:handleBuy,loading:isLoading,style:styles.buyButton})]});};var styles=StyleSheet.create({container:{flex:1,padding:20,alignItems:'center'},title:{fontSize:24,fontWeight:'bold',marginBottom:20},inputContainer:{flexDirection:'row',alignItems:'center',marginBottom:10},input:{flex:1,height:40,borderWidth:1,borderRadius:5,paddingHorizontal:10,marginRight:10},currencyToggle:{width:60},conversionText:{marginBottom:20},buyButton:{width:'100%'}});export default BuyBitcoinScreen;","map":{"version":3,"names":["React","useState","useContext","View","Text","StyleSheet","TextInput","Alert","useTheme","WalletContext","Button","axios","jsx","_jsx","jsxs","_jsxs","BuyBitcoinScreen","_useTheme","colors","_useContext","exchangeRates","_useState","_useState2","_slicedToArray","amount","setAmount","_useState3","_useState4","isBtc","setIsBtc","_useState5","_useState6","isLoading","setIsLoading","handleBuy","_ref","_asyncToGenerator","response","get","params","apiKey","baseCurrencyAmount","parseFloat","bitcoin","usd","toFixed","baseCurrencyCode","fixed","_response$data","data","quoteCurrencyAmount","feeAmount","extraFeeAmount","networkFeeAmount","totalAmount","alert","text","style","onPress","initiateTransaction","error","console","apply","arguments","_ref2","_x","toggleCurrency","styles","container","backgroundColor","background","children","title","color","inputContainer","input","borderColor","border","value","onChangeText","keyboardType","placeholder","placeholderTextColor","currencyToggle","conversionText","loading","buyButton","create","flex","padding","alignItems","fontSize","fontWeight","marginBottom","flexDirection","height","borderWidth","borderRadius","paddingHorizontal","marginRight","width"],"sources":["C:/appdev/btcwallet/src/screens/BuyBitcoinScreen.js"],"sourcesContent":["import React, { useState, useContext } from 'react';\r\nimport { View, Text, StyleSheet, TextInput, Alert } from 'react-native';\r\nimport { useTheme } from '../contexts/ThemeContext';\r\nimport { WalletContext } from '../contexts/WalletContext';\r\nimport Button from '../components/Button';\r\nimport axios from 'axios';\r\n\r\nconst BuyBitcoinScreen = () => {\r\n  const { colors } = useTheme();\r\n  const { exchangeRates } = useContext(WalletContext);\r\n  const [amount, setAmount] = useState('');\r\n  const [isBtc, setIsBtc] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const handleBuy = async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      const response = await axios.get('https://api.moonpay.com/v3/currencies/btc/buy_quote', {\r\n        params: {\r\n          apiKey: 'YOUR_MOONPAY_API_KEY',\r\n          baseCurrencyAmount: isBtc ? (parseFloat(amount) / exchangeRates.bitcoin.usd).toFixed(2) : amount,\r\n          baseCurrencyCode: 'usd',\r\n          fixed: true\r\n        }\r\n      });\r\n\r\n      const { quoteCurrencyAmount, feeAmount, extraFeeAmount, networkFeeAmount, totalAmount } = response.data;\r\n\r\n      Alert.alert(\r\n        'Buy Bitcoin',\r\n        `You will receive ${quoteCurrencyAmount} BTC for ${totalAmount} USD (including fees)`,\r\n        [\r\n          { text: 'Cancel', style: 'cancel' },\r\n          { text: 'Confirm', onPress: () => initiateTransaction(totalAmount) }\r\n        ]\r\n      );\r\n    } catch (error) {\r\n      console.error('Error fetching MoonPay quote:', error);\r\n      Alert.alert('Error', 'Failed to get quote from MoonPay');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const initiateTransaction = async (totalAmount) => {\r\n    // Here you would typically redirect to MoonPay's widget or handle the transaction\r\n    // For this example, we'll just show an alert\r\n    Alert.alert('Transaction Initiated', `You're being redirected to complete the purchase of ${amount} ${isBtc ? 'BTC' : 'USD'} worth of Bitcoin.`);\r\n  };\r\n\r\n  const toggleCurrency = () => {\r\n    setIsBtc(!isBtc);\r\n    setAmount('');\r\n  };\r\n\r\n  return (\r\n    <View style={[styles.container, { backgroundColor: colors.background }]}>\r\n      <Text style={[styles.title, { color: colors.text }]}>Buy Bitcoin</Text>\r\n      <View style={styles.inputContainer}>\r\n        <TextInput\r\n          style={[styles.input, { color: colors.text, borderColor: colors.border }]}\r\n          value={amount}\r\n          onChangeText={setAmount}\r\n          keyboardType=\"numeric\"\r\n          placeholder={`Enter amount in ${isBtc ? 'BTC' : 'USD'}`}\r\n          placeholderTextColor={colors.placeholder}\r\n        />\r\n        <Button title={isBtc ? 'BTC' : 'USD'} onPress={toggleCurrency} style={styles.currencyToggle} />\r\n      </View>\r\n      {!isBtc && (\r\n        <Text style={[styles.conversionText, { color: colors.text }]}>\r\n          â‰ˆ {amount ? (parseFloat(amount) / exchangeRates.bitcoin.usd).toFixed(8) : '0'} BTC\r\n        </Text>\r\n      )}\r\n      <Button title=\"Buy Bitcoin\" onPress={handleBuy} loading={isLoading} style={styles.buyButton} />\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    padding: 20,\r\n    alignItems: 'center',\r\n  },\r\n  title: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    marginBottom: 20,\r\n  },\r\n  inputContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginBottom: 10,\r\n  },\r\n  input: {\r\n    flex: 1,\r\n    height: 40,\r\n    borderWidth: 1,\r\n    borderRadius: 5,\r\n    paddingHorizontal: 10,\r\n    marginRight: 10,\r\n  },\r\n  currencyToggle: {\r\n    width: 60,\r\n  },\r\n  conversionText: {\r\n    marginBottom: 20,\r\n  },\r\n  buyButton: {\r\n    width: '100%',\r\n  },\r\n});\r\n\r\nexport default BuyBitcoinScreen;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}